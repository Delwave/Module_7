import os
import time
import shutil

# === –ù–ê–°–¢–†–û–ô–ö–ò ===
SOURCE_DIR = r"C:\Users\YourName\Desktop\source"   # –ø–∞–ø–∫–∞-–∏—Å—Ç–æ—á–Ω–∏–∫
TARGET_DIR = r"C:\Users\YourName\Desktop\target"   # –ø–∞–ø–∫–∞-–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
PREFIX = "GR_8_"                                   # –ø—Ä–µ—Ñ–∏–∫—Å –∏—Å–∫–æ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
CHECK_INTERVAL = 2                                 # –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ (—Å–µ–∫—É–Ω–¥—ã)


def is_file_ready(filepath):
    """–ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª (–∑–Ω–∞—á–∏—Ç –æ–Ω –¥–æ–≥—Ä—É–∑–∏–ª—Å—è)."""
    try:
        with open(filepath, "rb"):
            return True
    except (PermissionError, OSError):
        return False


def main():
    print("üöÄ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—â–µ–Ω–∞. –û–∂–∏–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤...")
    while True:
        try:
            for filename in os.listdir(SOURCE_DIR):
                if filename.startswith(PREFIX):
                    source_path = os.path.join(SOURCE_DIR, filename)
                    target_path = os.path.join(TARGET_DIR, filename)

                    if is_file_ready(source_path):
                        try:
                            shutil.move(source_path, target_path)
                            print(f"‚úÖ –§–∞–π–ª {filename} –ø–µ—Ä–µ–º–µ—â—ë–Ω")
                        except Exception as e:
                            print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ {filename}: {e}")
                    else:
                        print(f"‚è≥ –§–∞–π–ª {filename} –µ—â–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...")
            time.sleep(CHECK_INTERVAL)
        except KeyboardInterrupt:
            print("\nüõë –†–∞–±–æ—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.")
            break
        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞: {e}")
            time.sleep(5)


if __name__ == "__main__":
    main()